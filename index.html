<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .completed {
            text-decoration: line-through;
            opacity: 0.6;
        }
        .task-card {
            transition: all 0.3s ease;
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center mb-4">üìù Task Manager (Frontend Version)</h1>
        
        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h5>
                <form id="taskForm">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="taskTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
                    </div>
                    <div class="mb-3">
                        <textarea class="form-control" id="taskDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</label>
                        <input type="date" class="form-control" id="taskDueDate">
                    </div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                </form>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="mb-3">
            <button class="btn btn-outline-secondary" onclick="filterTasks('all')">–í—Å–µ –∑–∞–¥–∞—á–∏</button>
            <button class="btn btn-outline-warning" onclick="filterTasks('pending')">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</button>
            <button class="btn btn-outline-success" onclick="filterTasks('completed')">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</button>
            <button class="btn btn-info float-end" onclick="showStats()">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div id="alertContainer"></div>

        <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
        <div id="tasksContainer">
            <div class="alert alert-info text-center">
                –ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="modal fade" id="statsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card text-white bg-primary mb-3">
                                <div class="card-body text-center">
                                    <h4 id="totalTasks">0</h4>
                                    <p class="card-text">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-white bg-success mb-3">
                                <div class="card-body text-center">
                                    <h4 id="completedTasks">0</h4>
                                    <p class="card-text">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-white bg-warning mb-3">
                                <div class="card-body text-center">
                                    <h4 id="pendingTasks">0</h4>
                                    <p class="card-text">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–¥–∞—á –≤ LocalStorage
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        let currentFilter = 'all';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            renderTasks();
            document.getElementById('taskForm').addEventListener('submit', addTask);
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
        function addTask(e) {
            e.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const dueDate = document.getElementById('taskDueDate').value;

            const newTask = {
                id: Date.now(),
                title: title,
                description: description,
                status: 'pending',
                created_at: new Date().toISOString(),
                due_date: dueDate
            };

            tasks.push(newTask);
            saveTasks();
            renderTasks();
            showAlert('–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('taskForm').reset();
        }

        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
        function toggleStatus(taskId) {
            tasks = tasks.map(task => {
                if (task.id === taskId) {
                    task.status = task.status === 'completed' ? 'pending' : 'completed';
                }
                return task;
            });
            saveTasks();
            renderTasks();
            showAlert('–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
        function deleteTask(taskId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?')) {
                tasks = tasks.filter(task => task.id !== taskId);
                saveTasks();
                renderTasks();
                showAlert('–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!', 'success');
            }
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á
        function filterTasks(status) {
            currentFilter = status;
            renderTasks();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function showStats() {
            const total = tasks.length;
            const completed = tasks.filter(task => task.status === 'completed').length;
            const pending = tasks.filter(task => task.status === 'pending').length;

            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('pendingTasks').textContent = pending;

            const statsModal = new bootstrap.Modal(document.getElementById('statsModal'));
            statsModal.show();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–¥–∞—á
        function renderTasks() {
            const container = document.getElementById('tasksContainer');
            
            let filteredTasks = tasks;
            if (currentFilter === 'completed') {
                filteredTasks = tasks.filter(task => task.status === 'completed');
            } else if (currentFilter === 'pending') {
                filteredTasks = tasks.filter(task => task.status === 'pending');
            }

            if (filteredTasks.length === 0) {
                container.innerHTML = '<div class="alert alert-info text-center">–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!</div>';
                return;
            }

            container.innerHTML = filteredTasks.map(task => `
                <div class="card task-card mb-3 ${task.status === 'completed' ? 'border-success' : ''}">
                    <div class="card-body">
                        <h5 class="card-title ${task.status === 'completed' ? 'completed' : ''}">
                            ${task.title}
                        </h5>
                        ${task.description ? `
                            <p class="card-text ${task.status === 'completed' ? 'completed' : ''}">
                                ${task.description}
                            </p>
                        ` : ''}
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                –°–æ–∑–¥–∞–Ω–æ: ${task.created_at.slice(0, 10)}
                                ${task.due_date ? `| –°—Ä–æ–∫: ${task.due_date}` : ''}
                            </small>
                            <div>
                                <button onclick="toggleStatus(${task.id})" 
                                   class="btn btn-sm ${task.status === 'completed' ? 'btn-warning' : 'btn-success'}">
                                    ${task.status === 'completed' ? '–í–µ—Ä–Ω—É—Ç—å –≤ —Ä–∞–±–æ—Ç—É' : '–í—ã–ø–æ–ª–Ω–∏—Ç—å'}
                                </button>
                                <button onclick="deleteTask(${task.id})" 
                                   class="btn btn-sm btn-danger">
                                    –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
            
            alertContainer.innerHTML = `
                <div class="alert ${alertClass} alert-dismissible fade show">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                alertContainer.innerHTML = '';
            }, 3000);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ LocalStorage
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }
    </script>
</body>
</html>
